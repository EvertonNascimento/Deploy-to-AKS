trigger:
- main
resources:
- repo: self

variables:
  imagerepo: sampleapp
  tag: '$(Build.BuildId)'

stages:
  - stage: Build
    displayName: Build image
    jobs:
      - job: Build
        displayName: Build
        pool:
          vmImage: ubuntu-latest
        steps:

        - task: Docker@2
          inputs:
            containerRegistry: 'evertonacr'
            repository: '$(imagerepo)'
            command: 'buildAndPush'

  - stage: Deploy
    displayName: deploy to aks
    jobs:
    - job: deploy
      displayName: deploy do aks
      pool: testpool
      steps:
        - task:
            

